!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.supercluster=t()}}(function(){return function t(n,o,e){function i(s,u){if(!o[s]){if(!n[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(r)return r(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var p=o[s]={exports:{}};n[s][0].call(p.exports,function(t){var o=n[s][1][t];return i(o?o:t)},p,p.exports,t,n,o,e)}return o[s].exports}for(var r="function"==typeof require&&require,s=0;s<e.length;s++)i(e[s]);return i}({1:[function(t,n){"use strict";function o(t){return new e(t)}function e(t){this.options=c(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function i(t,n,o,e,i){return{x:t,y:n,zoom:1/0,id:e,properties:i,parentId:-1,numPoints:o}}function r(t,n){var o=t.geometry.coordinates;return{x:a(o[0]),y:h(o[1]),zoom:1/0,id:n,parentId:-1}}function s(t){return{type:"Feature",properties:u(t),geometry:{type:"Point",coordinates:[p(t.x),f(t.y)]}}}function u(t){var n=t.numPoints,o=n>=1e4?Math.round(n/1e3)+"k":n>=1e3?Math.round(n/100)/10+"k":n;return c(c({},t.properties),{cluster:!0,cluster_id:t.id,point_count:n,point_count_abbreviated:o})}function a(t){return t/360+.5}function h(t){var n=Math.sin(t*Math.PI/180),o=.5-.25*Math.log((1+n)/(1-n))/Math.PI;return 0>o?0:o>1?1:o}function p(t){return 360*(t-.5)}function f(t){var n=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(n))/Math.PI-90}function c(t,n){for(var o in n)t[o]=n[o];return t}function d(t){return t.x}function l(t){return t.y}var m=t("kdbush");n.exports=o,e.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(t){var n=this.options.log;n&&console.time("total time");var o="prepare "+t.length+" points";n&&console.time(o),this.points=t;var e=t.map(r);n&&console.timeEnd(o);for(var i=this.options.maxZoom;i>=this.options.minZoom;i--){var s=+Date.now();this.trees[i+1]=m(e,d,l,this.options.nodeSize,Float32Array),e=this._cluster(e,i),n&&console.log("z%d: %d clusters in %dms",i,e.length,+Date.now()-s)}return this.trees[this.options.minZoom]=m(e,d,l,this.options.nodeSize,Float32Array),n&&console.timeEnd("total time"),this},getClusters:function(t,n){for(var o=this.trees[this._limitZoom(n)],e=o.range(a(t[0]),h(t[3]),a(t[2]),h(t[1])),i=[],r=0;r<e.length;r++){var u=o.points[e[r]];i.push(u.numPoints?s(u):this.points[u.id])}return i},getChildren:function(t,n){for(var o=this.trees[n+1].points[t],e=this.options.radius/(this.options.extent*Math.pow(2,n)),i=this.trees[n+1].within(o.x,o.y,e),r=[],u=0;u<i.length;u++){var a=this.trees[n+1].points[i[u]];a.parentId===t&&r.push(a.numPoints?s(a):this.points[a.id])}return r},getLeaves:function(t,n,o,e){o=o||10,e=e||0;var i=[];return this._appendLeaves(i,t,n,o,e,0),i},getTile:function(t,n,o){var e=this.trees[this._limitZoom(t)],i=Math.pow(2,t),r=this.options.extent,s=this.options.radius,u=s/r,a=(o-u)/i,h=(o+1+u)/i,p={features:[]};return this._addTileFeatures(e.range((n-u)/i,a,(n+1+u)/i,h),e.points,n,o,i,p),0===n&&this._addTileFeatures(e.range(1-u/i,a,1,h),e.points,i,o,i,p),n===i-1&&this._addTileFeatures(e.range(0,a,u/i,h),e.points,-1,o,i,p),p.features.length?p:null},getClusterExpansionZoom:function(t,n){for(;n<this.options.maxZoom;){var o=this.getChildren(t,n);if(n++,1!==o.length)break;t=o[0].properties.cluster_id}return n},_appendLeaves:function(t,n,o,e,i,r){for(var s=this.getChildren(n,o),u=0;u<s.length;u++){var a=s[u].properties;if(a.cluster?r+a.point_count<=i?r+=a.point_count:r=this._appendLeaves(t,a.cluster_id,o+1,e,i,r):i>r?r++:t.push(s[u]),t.length===e)break}return r},_addTileFeatures:function(t,n,o,e,i,r){for(var s=0;s<t.length;s++){var a=n[t[s]];r.features.push({type:1,geometry:[[Math.round(this.options.extent*(a.x*i-o)),Math.round(this.options.extent*(a.y*i-e))]],tags:a.numPoints?u(a):this.points[a.id].properties})}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,n){for(var o=[],e=this.options.radius/(this.options.extent*Math.pow(2,n)),r=0;r<t.length;r++){var s=t[r];if(!(s.zoom<=n)){s.zoom=n;var u=this.trees[n+1],a=u.within(s.x,s.y,e),h=s.numPoints||1,p=s.x*h,f=s.y*h,c=null;this.options.reduce&&(c=this.options.initial(),this._accumulate(c,s));for(var d=0;d<a.length;d++){var l=u.points[a[d]];if(n<l.zoom){var m=l.numPoints||1;l.zoom=n,p+=l.x*m,f+=l.y*m,h+=m,l.parentId=r,this.options.reduce&&this._accumulate(c,l)}}1===h?o.push(s):(s.parentId=r,o.push(i(p/h,f/h,h,r,c)))}}return o},_accumulate:function(t,n){var o=n.numPoints?n.properties:this.options.map(this.points[n.id].properties);this.options.reduce(t,o)}}},{kdbush:2}],2:[function(t,n){"use strict";function o(t,n,o,i,r){return new e(t,n,o,i,r)}function e(t,n,o,e,u){n=n||i,o=o||r,u=u||Array,this.nodeSize=e||64,this.points=t,this.ids=new u(t.length),this.coords=new u(2*t.length);for(var a=0;a<t.length;a++)this.ids[a]=a,this.coords[2*a]=n(t[a]),this.coords[2*a+1]=o(t[a]);s(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function i(t){return t[0]}function r(t){return t[1]}var s=t("./sort"),u=t("./range"),a=t("./within");n.exports=o,e.prototype={range:function(t,n,o,e){return u(this.ids,this.coords,t,n,o,e,this.nodeSize)},within:function(t,n,o){return a(this.ids,this.coords,t,n,o,this.nodeSize)}}},{"./range":3,"./sort":4,"./within":5}],3:[function(t,n){"use strict";function o(t,n,o,e,i,r,s){for(var u,a,h=[0,t.length-1,0],p=[];h.length;){var f=h.pop(),c=h.pop(),d=h.pop();if(s>=c-d)for(var l=d;c>=l;l++)u=n[2*l],a=n[2*l+1],u>=o&&i>=u&&a>=e&&r>=a&&p.push(t[l]);else{var m=Math.floor((d+c)/2);u=n[2*m],a=n[2*m+1],u>=o&&i>=u&&a>=e&&r>=a&&p.push(t[m]);var v=(f+1)%2;(0===f?u>=o:a>=e)&&(h.push(d),h.push(m-1),h.push(v)),(0===f?i>=u:r>=a)&&(h.push(m+1),h.push(c),h.push(v))}}return p}n.exports=o},{}],4:[function(t,n){"use strict";function o(t,n,i,r,s,u){if(!(i>=s-r)){var a=Math.floor((r+s)/2);e(t,n,a,r,s,u%2),o(t,n,i,r,a-1,u+1),o(t,n,i,a+1,s,u+1)}}function e(t,n,o,r,s,u){for(;s>r;){if(s-r>600){var a=s-r+1,h=o-r+1,p=Math.log(a),f=.5*Math.exp(2*p/3),c=.5*Math.sqrt(p*f*(a-f)/a)*(0>h-a/2?-1:1),d=Math.max(r,Math.floor(o-h*f/a+c)),l=Math.min(s,Math.floor(o+(a-h)*f/a+c));e(t,n,o,d,l,u)}var m=n[2*o+u],v=r,g=s;for(i(t,n,r,o),n[2*s+u]>m&&i(t,n,r,s);g>v;){for(i(t,n,v,g),v++,g--;n[2*v+u]<m;)v++;for(;n[2*g+u]>m;)g--}n[2*r+u]===m?i(t,n,r,g):(g++,i(t,n,g,s)),o>=g&&(r=g+1),g>=o&&(s=g-1)}}function i(t,n,o,e){r(t,o,e),r(n,2*o,2*e),r(n,2*o+1,2*e+1)}function r(t,n,o){var e=t[n];t[n]=t[o],t[o]=e}n.exports=o},{}],5:[function(t,n){"use strict";function o(t,n,o,i,r,s){for(var u=[0,t.length-1,0],a=[],h=r*r;u.length;){var p=u.pop(),f=u.pop(),c=u.pop();if(s>=f-c)for(var d=c;f>=d;d++)e(n[2*d],n[2*d+1],o,i)<=h&&a.push(t[d]);else{var l=Math.floor((c+f)/2),m=n[2*l],v=n[2*l+1];e(m,v,o,i)<=h&&a.push(t[l]);var g=(p+1)%2;(0===p?m>=o-r:v>=i-r)&&(u.push(c),u.push(l-1),u.push(g)),(0===p?o+r>=m:i+r>=v)&&(u.push(l+1),u.push(f),u.push(g))}}return a}function e(t,n,o,e){var i=t-o,r=n-e;return i*i+r*r}n.exports=o},{}]},{},[1])(1)});